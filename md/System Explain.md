# ุดุฑุญ ููุฏ ุงูุฑูุจูุช ุงููุชุฒู ุฐุงุชูุงู - ุนูุชุฑ

## ูุธุฑุฉ ุนุงูุฉ
ูุฐุง ุงููุดุฑูุน ุนุจุงุฑุฉ ุนู ุฑูุจูุช ูุชุฒู ุฐุงุชูุงู ุนูู ุนุฌูุชูู ูุณุชุฎุฏู ุญุณุงุณ ุงูุฌูุฑูุณููุจ MPU6050 ููุชุญูู PID ููุญูุงุธ ุนูู ุงูุชูุงุฒูุ ูุน ุฅููุงููุฉ ุงูุชุญูู ููู ุนุจุฑ ุงูุจููุชูุซ.

---

## 1. ุงูููุชุจุงุช ุงููุณุชุฎุฏูุฉ

```cpp
#include "PID_v1.h"                      // ููุชุจุฉ ุงูุชุญูู PID
#include "LMotorController.h"            // ููุชุจุฉ ุงูุชุญูู ูู ุงููุญุฑูุงุช
#include "I2Cdev.h"                      // ููุชุจุฉ ุงูุชูุงุตู I2C
#include "MPU6050_6Axis_MotionApps20.h"  // ููุชุจุฉ ุญุณุงุณ ุงูุฌูุฑูุณููุจ MPU6050
#include <LiquidCrystal_I2C.h>           // ููุชุจุฉ ุดุงุดุฉ LCD
#include <SoftwareSerial.h>              // ููุชุจุฉ ุงูุจููุชูุซ
```

**ุงูุดุฑุญ:**
- **PID_v1**: ููุชุญูู ุงูุฃูุชููุงุชููู ูู ุงูุชูุงุฒู ุจุงุณุชุฎุฏุงู ุฎูุงุฑุฒููุฉ PID
- **LMotorController**: ููุชุญูู ูู ูุญุฑููู DC ุนุจุฑ H-Bridge (L298N)
- **I2Cdev**: ููุชูุงุตู ูุน ุงูุญุณุงุณุงุช ุนุจุฑ ุจุฑูุชูููู I2C
- **MPU6050**: ููุฑุงุกุฉ ุงูุฒูุงูุง ูุงูุญุฑูุฉ ูู ุญุณุงุณ ุงูุฌูุฑูุณููุจ
- **LiquidCrystal_I2C**: ูุนุฑุถ ุงูุจูุงูุงุช ุนูู ุดุงุดุฉ LCD 16x2
- **SoftwareSerial**: ููุชูุงุตู ูุน ูุญุฏุฉ ุงูุจููุชูุซ HC-05

---

## 2. ุชุนุฑูู ุงูุซูุงุจุช ูุงูุจูุงุช (Pins)

```cpp
#define MIN_ABS_SPEED 20        // ุงูุญุฏ ุงูุฃุฏูู ูุณุฑุนุฉ ุงููุญุฑู
#define BUZZER_PIN 11           // ุจู ุงูุตูุงุฑุฉ
#define BT_RX 12                // ุจู ุงุณุชูุจุงู ุงูุจููุชูุซ
#define BT_TX 13                // ุจู ุฅุฑุณุงู ุงูุจููุชูุซ
#define ANGLE_THRESHOLD 30      // ุญุฏ ุชุดุบูู ุงูุตูุงุฑุฉ ุนูุฏ ุงููููุงู
```

**ุชูุตูู ุงูุจูุงุช:**
- **ุงูุจู 11**: ุตูุงุฑุฉ ุงูุชุญุฐูุฑ (ุชุนูู ุนูุฏ ุงููููุงู ุงูุดุฏูุฏ)
- **ุงูุจู 12 ู 13**: ูุญุฏุฉ ุงูุจููุชูุซ HC-05 (RX, TX)
- **ุงูุจูุงุช 5-10**: ูุญุฑูุงุช DC ุนุจุฑ L298N (ENA, IN1-4, ENB)

---

## 3. ุชุนุฑูู ุงูุฃุฌูุฒุฉ

```cpp
MPU6050 mpu;                                    // ุญุณุงุณ ุงูุฌูุฑูุณููุจ
LiquidCrystal_I2C lcd(0x27, 16, 2);            // ุดุงุดุฉ LCD ุจุนููุงู 0x27
SoftwareSerial bluetooth(BT_RX, BT_TX);        // ูุญุฏุฉ ุงูุจููุชูุซ
```

---

## 4. ูุชุบูุฑุงุช MPU6050

```cpp
bool dmpReady = false;          // ูู DMP ุฌุงูุฒุ
uint8_t mpuIntStatus;           // ุญุงูุฉ ุงูููุงุทุนุฉ (interrupt)
uint8_t devStatus;              // ุญุงูุฉ ุงูุชููุฆุฉ
uint16_t packetSize;            // ุญุฌู ุญุฒูุฉ ุงูุจูุงูุงุช
uint16_t fifoCount;             // ุนุฏุฏ ุงูุจุงูุชุงุช ูู FIFO
uint8_t fifoBuffer[64];         // ูุฎุฒู ูุคูุช ููุจูุงูุงุช
```

**ุงูุดุฑุญ:**
- **DMP** (Digital Motion Processor): ูุนุงูุฌ ุฑููู ุฏุงุฎู MPU6050 ูุญุณุจ ุงูุฒูุงูุง ุชููุงุฆูุงู
- **FIFO**: ุฐุงูุฑุฉ ูุคูุชุฉ ุชุฎุฒู ุงููุฑุงุกุงุช

---

## 5. ูุชุบูุฑุงุช ุงูุฒูุงูุง ูุงูุญุฑูุฉ

```cpp
Quaternion q;           // ุฑุจุงุนู ุงูุฃุจุนุงุฏ (Quaternion) ูุชูุซูู ุงูุฏูุฑุงู
VectorFloat gravity;    // ูุชุฌู ุงูุฌุงุฐุจูุฉ
float ypr[3];          // ุงูุฒูุงูุง: Yaw (ุงูุฏูุฑุงู), Pitch (ุงูุฃูุงู/ุงูุฎูู), Roll (ุงููููู/ุงูุดูุงู)
```

**ุงูุดุฑุญ:**
- **ypr[0]**: ุฒุงููุฉ ุงูุฏูุฑุงู ุญูู ุงููุญูุฑ ุงูุนููุฏู
- **ypr[1]**: ุฒุงููุฉ ุงููููุงู ููุฃูุงู/ุงูุฎูู (ุงููููุฉ ููุชูุงุฒู)
- **ypr[2]**: ุฒุงููุฉ ุงููููุงู ูููููู/ุงูุดูุงู

---

## 6. ูุชุบูุฑุงุช ุงูุชุญูู PID

```cpp
double originalSetpoint = 175;   // ุงูุฒุงููุฉ ุงููุณุชูุฏูุฉ ููุชูุงุฒู
double setpoint = originalSetpoint;
double input, output;            // ุงููุฏุฎู ูุงููุฎุฑุฌ ูู PID
double Kp = 22;                  // ูุนุงูู ุงูุชูุงุณุจ (Proportional)
double Kd = 1.5;                 // ูุนุงูู ุงููุดุชู (Derivative)
double Ki = 140;                 // ูุนุงูู ุงูุชูุงูู (Integral)
```

**ุดุฑุญ PID:**
- **Kp**: ูุชุญูู ูู ููุฉ ุงูุงุณุชุฌุงุจุฉ ุงูููุฑูุฉ ููุฎุทุฃ
- **Ki**: ูุตุญุญ ุงูุฃุฎุทุงุก ุงููุชุฑุงููุฉ ูุน ุงูุฒูู
- **Kd**: ูููู ุงูุชุฐุจุฐุจ ููุญุณู ุงูุงุณุชูุฑุงุฑ

---

## 7. ูุชุบูุฑุงุช ุงูุชุญูู ุจุงูุญุฑูุฉ

```cpp
char btCommand = '0';                // ุงูุฃูุฑ ุงููุณุชูุจู ูู ุงูุจููุชูุซ
double targetSetpoint = 175;         // ุงูุฒุงููุฉ ุงููุณุชูุฏูุฉ (ูุน ุงูุญุฑูุฉ)
double turnOffset = 0;               // ูุฑู ุงูุณุฑุนุฉ ุจูู ุงูุนุฌูุชูู ููุฏูุฑุงู
double targetTurnOffset = 0;         // ุงููุฏู ูู ูุฑู ุงูุณุฑุนุฉ
unsigned long moveStartTime = 0;     // ููุช ุจุฏุงูุฉ ุงูุญุฑูุฉ
bool isMoving = false;               // ูู ุงูุฑูุจูุช ูุชุญุฑูุ
```

**ุงูุดุฑุญ:**
- ุนูุฏ ุงูุญุฑูุฉ ููุฃูุงู: ูููู `setpoint` ููููุงู ููููู ุงูุฑูุจูุช ููุฃูุงู
- ุนูุฏ ุงูุฏูุฑุงู: ูุบูุฑ ุณุฑุนุฉ ุนุฌูุฉ ุนู ุงูุฃุฎุฑู ุจุงุณุชุฎุฏุงู `turnOffset`
- **Auto-stop**: ุจุนุฏ 500ms ูู ุงูุฃูุฑุ ูุชููู ุชููุงุฆูุงู

---

## 8. ุฏุงูุฉ ุงูุฅุนุฏุงุฏ setup()

### 8.1 ุชููุฆุฉ ุงูุฃุฌูุฒุฉ ุงูุทุฑููุฉ
```cpp
pinMode(BUZZER_PIN, OUTPUT);
bluetooth.begin(9600);
lcd.init();
lcd.print("Hi I'm ANTER");
```

### 8.2 ุชููุฆุฉ MPU6050
```cpp
mpu.initialize();
mpu.dmpInitialize();
mpu.setXGyroOffset(220);   // ูุนุงูุฑุฉ ุงููุญูุฑ X
mpu.setYGyroOffset(76);    // ูุนุงูุฑุฉ ุงููุญูุฑ Y
mpu.setZGyroOffset(-85);   // ูุนุงูุฑุฉ ุงููุญูุฑ Z
mpu.setZAccelOffset(1788); // ูุนุงูุฑุฉ ูููุงุณ ุงูุชุณุงุฑุน
```

**ููุงุญุธุฉ:** ูุฐู ุงูููู ุชุฎุชูู ูู ุฑูุจูุช ูุขุฎุฑ ูุชุญุชุงุฌ ูุนุงูุฑุฉ

### 8.3 ุชููุฆุฉ PID
```cpp
pid.SetMode(AUTOMATIC);      // ุชุดุบูู ุงููุถุน ุงูุฃูุชููุงุชููู
pid.SetSampleTime(10);       // ูุชุฑุฉ ุงูุชุญุฏูุซ 10ms
pid.SetOutputLimits(-255, 255); // ุญุฏูุฏ ุณุฑุนุฉ ุงููุญุฑู
```

---

## 9. ุงูุฏุงูุฉ ุงูุฑุฆูุณูุฉ loop()

### 9.1 ูุฑุงุกุฉ ุฃูุงูุฑ ุงูุจููุชูุซ
```cpp
if (bluetooth.available())
{
    btCommand = bluetooth.read();
    if (btCommand == '1')      // ูุฏุงู
        targetSetpoint = originalSetpoint - 5;
    else if (btCommand == '2') // ูุฑุง
        targetSetpoint = originalSetpoint + 5;
    else if (btCommand == '3') // ูููู
        targetTurnOffset = 30;
    else if (btCommand == '4') // ุดูุงู
        targetTurnOffset = -30;
}
```

**ุงูุฃูุงูุฑ:**
- **'1'**: ุชุญุฑู ููุฃูุงู (ูููู ููููุงู ููุฃูุงู)
- **'2'**: ุชุญุฑู ููุฎูู (ูููู ููููุงู ููุฎูู)
- **'3'**: ุฏูุฑุงู ูููููู (ุงูุนุฌูุฉ ุงููููู ุฃุจุทุฃ)
- **'4'**: ุฏูุฑุงู ูููุณุงุฑ (ุงูุนุฌูุฉ ุงููุณุฑู ุฃุจุทุฃ)

### 9.2 ุงูุชููู ุงูุชููุงุฆู
```cpp
if (isMoving && (millis() - moveStartTime > 500))
{
    targetSetpoint = originalSetpoint;
    targetTurnOffset = 0;
    isMoving = false;
}
```
ุจุนุฏ ูุตู ุซุงููุฉ ูู ุงูุฃูุฑุ ูุฑุฌุน ููุชูุงุฒู ุชููุงุฆูุงู

### 9.3 ุงูุงูุชูุงู ุงูุณูุณ (Smooth Transition)
```cpp
if (setpoint < targetSetpoint)
    setpoint += 0.5;  // ุฒูุงุฏุฉ ุชุฏุฑูุฌูุฉ
else if (setpoint > targetSetpoint)
    setpoint -= 0.5;  // ููุตุงู ุชุฏุฑูุฌู
```
ูููุน ุงูุญุฑูุฉ ุงูููุงุฌุฆุฉ ููุญุณู ุงูุงุณุชูุฑุงุฑ

### 9.4 ุญุณุงุจ PID ูุงูุชุญูู ุจุงููุญุฑูุงุช
```cpp
pid.Compute();                          // ุญุณุงุจ ุงูุฎุฑุฌ ูู PID
int leftMotorSpeed = output - turnOffset;
int rightMotorSpeed = output + turnOffset;
motorController.move(leftMotorSpeed, rightMotorSpeed, MIN_ABS_SPEED);
```

### 9.5 ูุฑุงุกุฉ ุงูุจูุงูุงุช ูู MPU6050
```cpp
mpu.getFIFOBytes(fifoBuffer, packetSize);
mpu.dmpGetQuaternion(&q, fifoBuffer);
mpu.dmpGetGravity(&gravity, &q);
mpu.dmpGetYawPitchRoll(ypr, &q, &gravity);
input = ypr[1] * 180 / M_PI + 180;  // ุชุญููู ูุฏุฑุฌุงุช ูุฅุถุงูุฉ offset
```

### 9.6 ุชุดุบูู ุงูุตูุงุฑุฉ ุนูุฏ ุงูุฎุทุฑ
```cpp
if (abs(input - originalSetpoint) > ANGLE_THRESHOLD)
    digitalWrite(BUZZER_PIN, HIGH);  // ุงูุฑูุจูุช ูุงู ูุซูุฑุงู!
else
    digitalWrite(BUZZER_PIN, LOW);
```

---

## 10. ููู ูุนูู ุงููุธุงูุ

### ุฏูุฑุฉ ุงูุชุญูู ุงููุงููุฉ:
1. **MPU6050** ููุฑุฃ ุฒุงููุฉ ุงููููุงู ุงูุญุงููุฉ
2. **PID Controller** ูุญุณุจ ุงูุฎุทุฃ (ุงููุฑู ุจูู ุงูุฒุงููุฉ ุงูุญุงููุฉ ูุงููุณุชูุฏูุฉ)
3. **PID** ูุญุณุจ ุงูุณุฑุนุฉ ุงููุทููุจุฉ ูููุญุฑูุงุช ูุชุตุญูุญ ุงูุฎุทุฃ
4. **ุงููุญุฑูุงุช** ุชุฏูุฑ ุจุงูุณุฑุนุฉ ุงููุญุณูุจุฉ
5. **ุงูุฑูุจูุช** ูุชุญุฑู ููุบูุฑ ุฒุงููุชู
6. ุชูุฑุงุฑ ุงูุฏูุฑุฉ ูู 10ms ุชูุฑูุจุงู

### ูุซุงู:
- ุงูุฑูุจูุช ูููู ููุฃูุงู โ MPU6050 ููุชุดู ุงููููุงู
- PID ูุญุณุจ ุฃู ุงููุญุฑูุงุช ุชุญุชุงุฌ ุชุฏูุฑ ููุฃูุงู ุจุณุฑุนุฉ ูุนููุฉ
- ุงููุญุฑูุงุช ุชุฏูุฑ โ ุงูุฑูุจูุช ูุชุญุฑู ููุฃูุงู ููุนุฏู ููุณู
- ุนูุฏ ุงููุตูู ููุชูุงุฒู โ ุงูุณุฑุนุฉ = 0

---

## 11. ูุตุงุฆุญ ุงูุงุณุชุฎุฏุงู

### ุถุจุท PID:
- **Kp ูุจูุฑ ุฌุฏุงู**: ุชุฐุจุฐุจ ุณุฑูุน
- **Kp ุตุบูุฑ ุฌุฏุงู**: ุงุณุชุฌุงุจุฉ ุจุทูุฆุฉ
- **Ki ูุจูุฑ ุฌุฏุงู**: ุชุฐุจุฐุจ ุจุทูุก
- **Kd ูุจูุฑ ุฌุฏุงู**: ุญุณุงุณูุฉ ุนุงููุฉ ููุงูุชุฒุงุฒ

### ูุนุงูุฑุฉ MPU6050:
ุงุณุชุฎุฏู ุจุฑูุงูุฌ calibration ููุญุตูู ุนูู ุงูููู ุงูุตุญูุญุฉ ูู:
- `setXGyroOffset()`
- `setYGyroOffset()`
- `setZGyroOffset()`
- `setZAccelOffset()`

### ุชุญุณูู ุงูุฃุฏุงุก:
- ููู ูุฒู ุงูุฑูุจูุช ุงูุนููู
- ุงุฌุนู ูุฑูุฒ ุงูุซูู ููุฎูุถุงู
- ุงุณุชุฎุฏู ุจุทุงุฑูุฉ ูุณุชูุฑุฉ ุงูุฌูุฏ
- ุชุฃูุฏ ูู ุฌูุฏุฉ ุชูุตููุงุช ุงููุงุจูุงุช

---

## 12. ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

| ุงููุดููุฉ | ุงูุญู ุงููุญุชูู |
|---------|--------------|
| ุงูุฑูุจูุช ูุณูุท ููุฑุงู | ุถุจุท ููู PID ุฃู ูุนุงูุฑุฉ MPU6050 |
| ุงูุฑูุจูุช ูุชุฐุจุฐุจ | ุชูููู Kp ุฃู ุฒูุงุฏุฉ Kd |
| ูุง ูุณุชุฌูุจ ููุจููุชูุซ | ูุญุต ุชูุตูู RX/TX |
| ุงูุดุงุดุฉ ูุง ุชุนูู | ูุญุต ุนููุงู I2C (0x27 ุฃู 0x3F) |
| FIFO overflow | ุชุณุฑูุน ุงูููุฏ (ุชู ุญูู ุจุฅููุงู Serial.println) |

---

## ุงูุฎูุงุตุฉ
ูุฐุง ุงูููุฏ ูุฌูุน ุจูู:
- **ุงูุชุญูู ุงูุฐุงุชู** (PID + MPU6050)
- **ุงูุชุญูู ุงููุงุณููู** (Bluetooth)
- **ูุงุฌูุฉ ุงููุณุชุฎุฏู** (LCD + Buzzer)
- **ุงูุญุฑูุฉ ุงูุณูุณุฉ** (Smooth transitions)

ุงููุชูุฌุฉ: ุฑูุจูุช ูุชุฒู ูููู ุงูุชุญูู ููู ุจุณูููุฉ! ๐ค
